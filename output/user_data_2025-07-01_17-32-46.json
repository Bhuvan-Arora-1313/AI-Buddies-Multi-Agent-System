{
  "timestamp": "2025-07-01_17-32-46",
  "active_window": "ChatGPT",
  "focused_text": "Could not extract AXValue from focused element",
  "clipboard": "import datetime\nimport pytesseract\nfrom PIL import ImageGrab\nimport subprocess\nimport json\nimport time\nimport pyperclip\nimport platform\n\n# On Windows, import win32gui for window title\ntry:\n    import win32gui\n    import win32con\nexcept ImportError:\n    win32gui = None\n    win32con = None\n\ndef is_windows():\n    return platform.system() == \"Windows\"\n\n# Get active window title (cross-platform)\ndef get_active_window_title():\n    if is_windows():\n        try:\n            hwnd = win32gui.GetForegroundWindow()\n            return win32gui.GetWindowText(hwnd)\n        except Exception as e:\n            return f\"Error (Win): {e}\"\n    else:\n        try:\n            script = 'tell application \"System Events\" to get name of (processes where frontmost is true)'\n            output = subprocess.check_output(['osascript', '-e', script]).decode().strip()\n            return output\n        except Exception as e:\n            return f\"Error (Mac): {e}\"\n\n# Improved function: get_focused_text() returns the AXValue string or error message, not printing anything\ndef get_focused_text():\n    if is_windows():\n        # Just return clipboard text on Windows\n        try:\n            return pyperclip.paste()\n        except Exception as e:\n            return f\"Clipboard error (Win): {e}\"\n    else:\n        try:\n            script = '''\n            tell application \"System Events\"\n                set frontApp to name of first application process whose frontmost is true\n                if frontApp is \"Visual Studio Code\" then\n                    keystroke \"a\" using command down\n                    delay 0.2\n                    keystroke \"c\" using command down\n                    delay 0.2\n                    return \"CLIPBOARD\"\n                else\n                    tell application process frontApp\n                        try\n                            set focusedElement to value of attribute \"AXFocusedUIElement\"\n                            set focusedValue to value of attribute \"AXValue\" of focusedElement\n                            return focusedValue\n                        on error\n                            return \"Could not extract AXValue from focused element\"\n                        end try\n                    end tell\n                end if\n            end tell\n            '''\n            result = subprocess.run(['osascript', '-e', script], capture_output=True, text=True)\n            output = result.stdout.strip()\n            if output == \"CLIPBOARD\":\n                time.sleep(0.3)\n                clipboard_content = pyperclip.paste()\n                return clipboard_content\n            elif output == \"\":\n                return \"Could not extract AXValue from focused element\"\n            else:\n                return output\n        except Exception as e:\n            return f\"Error (Mac): {e}\"\n\n# Take screenshot\ndef capture_screenshot(filename):\n    img = ImageGrab.grab()\n    img.save(f\"output/{filename}\")\n    return img\n\n# Run OCR on image\ndef run_ocr(image):\n    text = pytesseract.image_to_string(image)\n    return text.strip()\n\n## Main capture logic (unchanged)\n\nif __name__ == \"__main__\":\n    import json\n    import time\n    import pyperclip\n    try:\n        while True:\n            timestamp = datetime.datetime.now().strftime(\"%Y-%m-%d_%H-%M-%S\")\n            screenshot_path = f\"screenshot_{timestamp}.png\"\n            active_window = get_active_window_title()\n            # Use get_focused_text() for textbox_text\n            textbox_text = get_focused_text()\n            # Clipboard logic: On Windows, clipboard and focused_text are the same; on Mac, they may differ\n            if is_windows():\n                clipboard_content = textbox_text\n            else:\n                clipboard_content = pyperclip.paste()\n            image = capture_screenshot(screenshot_path)\n            ocr_text = run_ocr(image)\n            import os\n            # Read the VS Code live text file (cross-platform)\n            vscode_text = \"\"\n            if platform.system() == \"Darwin\":\n                path = os.path.expanduser(\"~/Desktop/vscode_live_text.txt\")\n            elif platform.system() == \"Windows\":\n                path = os.path.expanduser(\"~/Desktop/vscode_live_text.txt\")\n            else:\n                path = \"/tmp/vscode_live_text.txt\"\n\n            try:\n                with open(path, \"r\", encoding=\"utf-8\") as f:\n                    vscode_text = f.read().strip()\n            except FileNotFoundError:\n                vscode_text = \"VS Code text not found.\"\n\n            data = {\n                \"timestamp\": timestamp,\n                \"active_window\": active_window,\n                \"focused_text\": textbox_text,\n                \"clipboard\": clipboard_content,\n                \"vscode_text\": vscode_text,\n                \"ocr_text\": ocr_text\n            }\n            with open(f\"output/user_data_{timestamp}.json\", \"w\") as f:\n                json.dump(data, f, indent=2)\n            with open(\"output/live_output.json\", \"w\") as f:\n                json.dump(data, f, indent=4)\n            time.sleep(20)\n    except KeyboardInterrupt:\n        print(\"Program interrupted by user.\")",
  "vscode_text": "<!DOCTYPE html>\n<html>\n  <body style=\"margin: 0; background: rgba(0,0,0,0.7); color: white; font-family: sans-serif;\">\n    <div style=\"-webkit-app-region: drag; padding: 10px; background: rgba(0,0,0,0.8);\">\n      <pre id=\"output\" style=\"white-space: pre-wrap; word-wrap: break-word;\">Waiting for data...</pre>\n    </div>\n    <script>\n      const { ipcRenderer } = require('electron');\n      ipcRenderer.on('update-prediction', (event, data) => {\n        document.getElementById('output').textContent = data;\n      });\n    </script>\n  </body>\n</html>",
  "ocr_text": "@ ChatGPT File\n\nyvvlliny,\n\n\u201c10 27\n-9 3:\nj 4\n\nJULY\nMTWTFS S\n@23 456\n7 8 9 1011 12 13\n14 15 16 17 18 19 20\n21 22 23 24 25 26 27\n28 29 30 31\n\nEdit View Window\u2019 Help\n\nPyCharm\n\nProjects\nCustomize\nPlugins\n\nLearn\n\nG6 &8 OBO S ww F Q S @ TueJul1 5:32PM\n\nll a\u00bb Sm \u2014\neee OG Popup JSON Viewer > CS\nBhuvan\nwn Wo Ww\nM ok so what was i supposed to do to\nupdate my git\nQ New Script New Project Open Clone Repository\nYou're doing great so far \u2014 and since you've already made your\nBuddy changes (including creating output_popup. py and editing other\n\nM files) inside your Buddy folder, and Git is already set up, here's\n\nstealth-popup exactly what you need to do:\n\nPyCharmMiscProject\n\nV Final Steps to Update GitHub with Your Changes\n\nPythonProject\n* Open Terminal and go to your Buddy repo folder:\nbash \u00a9 Copy\n\ncd ~/Buddy\n\nVa (Optional) See what's changed\n\nbash \u00a9 Copy\n\nTake a quick onboarding tour\n\nin\n\nStart Tour\n\u00a9) PyCharm (inactive) x\n\nMessage Bhuvan\n\n+@& im)\n980%eG8e29 G09908 \u2014~a-.\u00ae"
}